@(allVehicles: List[Vehicle])
@import helper._
@main("Our Fleet") {
@_menuBars()
<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

   @if(flash.get("addVehicleForMaintenance")){
   <div class="alert alert-danger" role="alert">
      <div class="container">
         @flash.get("addVehicleForMaintenance")
      </div>
   </div>
    }
    
     @if(flash.get("vehicleRemovedFromFleet")){
   <div class="alert alert-danger" role="alert">
      <div class="container">
         @flash.get("vehicleRemovedFromFleet")
      </div>
   </div>
   } 
   
   @if(flash.get("addVehicleForTravelOrder")){
   <div class="alert alert-danger" role="alert">
      <div class="container">
         @flash.get("addVehicleForMaintenance")
      </div>
   </div>
   }
   <div class="row">
      <div class="col-lg-12">
         <h2>ALL VEHICLES</h2>
         <a class="btn btn-info" href="/addVehicle"><i class="fa fa-plus-circle"></i>  Add New Vehicle</a>
         <br>
         <br>
         <div class="btn-group">
            <button id="updateStatusBtn" class="btn btn-default btn-sm dropdown-toggle" type="submit" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" disabled>
            Update Status <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
               <li>
                  <p>for petlja</p>
               </li>
               <li>
                  <p>sa statusima</p>
               </li>
            </ul>
         </div>
         <div class="btn-group">
            <form action="@routes.VehicleController.changeVehiclesType()" method="POST">
               <select id="indexSelect" class="form-control" id="typeName" name="typeName" onchange="this.form.submit()" disabled>
                  @if(Type.typesList() == null) {
                  <option value="">List of types is empty</option>
                  }
                  <option value="" style="display:none">Change Type</option>
                  @for(t <- Type.typesList()) {
                  <option value="@t.name">@t.name</option>
                  }   
               </select>
               <textarea style="display:none" id="taSignOff2" name="t2" readonly></textarea>
            </form>
            </ul>
         </div>
         <div class="btn-group">
            <form action="@routes.VehicleController.changeVehiclesFleet()" method="POST">
               <select id="indexSelect" class="form-control" id="fleetName" name="fleetName" onchange="this.form.submit()" disabled>
                  @if(Fleet.listOfFleets() == null) {
                  <option value="">List of fleets is empty</option>
                  }
                  <option value="" style="display:none">Change Fleet</option>
                  @for(fleet <- Fleet.listOfFleets()) { 
                  <option value="@fleet.name">@fleet.name</option>
                  }   
               </select>
               <textarea style="display:none" id="taSignOff1" name="t1" readonly></textarea>
            </form>
         </div>
         <div class="btn-group">
            <form action="@routes.VehicleController.deleteVehicles()" method="POST">
               <button id="deleteBtn" class="btn btn-danger btn-sm dropdown-toggle" onclick="return confirm('Are you sure you want to do this action?');" type="submit" disabled>
               Delete  <i class="glyphicon glyphicon-trash"></i>
               </button> 
               <textarea style="display:none" id="taSignOff" name="t" readonly></textarea> 
            </form>
         </div>
         <br>
         <br>
         <table class="table" id="myTable">
            <thead>
               <tr>
                  <th></th>
                  <th class="sorting">Vehicle ID <b class="caret"></b>
                  </th>
                  
                  <th class="sorting">Brand <b class="caret"></b>
                  </th>
                  <th class="sorting">Model <b class="caret"></b>
                  </th>
                  <th class="sorting">Type <b class="caret"></b>
                  </th>
                  <th class="sorting">Fleet <b class="caret"></b>
                  </th>
                  <th class="sorting">Owner <b class="caret"></b>
                  </th>
                  <th>Details</th>
                  <th>Edit</th>
               </tr>
            </thead>
            <tbody>
               @for(vehicle <- allVehicles) { 
               <tr>
                  <td><input type="checkbox" id="chk" name="vehicle" value="@vehicle.id"></td>
                  <td>@vehicle.vid</td>
                  @if(vehicle.vehicleBrand!=null){
                 <td>@vehicle.vehicleBrand.name</td>
                 }else{
    	      <td>N/A</td>
    	      }
                   @if(vehicle.vehicleModel!=null){
               <td>@vehicle.vehicleModel.name</td>
               }else{
               <td>N/A</td>
               }
                  <td>@vehicle.typev.name</td>
                  @if(vehicle.fleet == null || vehicle.fleet.name == "") {
                  <td>Not in any fleet</td>
                  } else {
                  <td>@vehicle.fleet.name</td>
                  }
                  <td>@vehicle.owner.name</td>
                  <td><a class="btn btn-info" data-toggle="modal" data-target="#myModal-@(vehicle.id)"><i class="glyphicon glyphicon-search"></i></a> </td>
                  <td> <a href="@routes.VehicleController.editVehicleView(vehicle.id)" class="btn btn-default"><i class="glyphicon glyphicon-pencil"></i></a>
                  </td>
               </tr>
               <!-- Modal -->
               <div id="myModal-@(vehicle.id)" class="modal fade" role="dialog">
                  <div class="modal-dialog">
                     <!-- Modal content-->
                     <div class="modal-content">
                        <div class="modal-header">
                           <button type="button" class="close" data-dismiss="modal">&times;</button>
                           <h4 class="modal-title"> @vehicle.typev.name details</h4>
                        </div>
                        <div class="modal-body">
                           <label>
                              <h4> Vehicle ID</h4>
                           </label>
                           @vehicle.vid </br>
                           <label>
                              <h4> Owner</h4>
                           </label>
                           </br>
                           <p>Name: @vehicle.owner.name </p>
                           </br>
                           <p> Email: @vehicle.owner.email</p>
                           </br>
                           <label>
                              <h4> Type  @vehicle.typev.name </h4>
                           </label>
                           </br>
                           @if(vehicle.fleet != null) {
                           <label>
                              <h4> Fleet Name   @vehicle.fleet.name </h4>
                           </label>
                           </br>
                           }
                           <label>
                              <h4> Description </h4>
                           </label>
                           </br>
                           @for(d <- vehicle.description) { 
                           <label>
                              <h4>@d.propertyName @d.propertyValue</h4>
                           </label>
                           </br>
                           }
                        </div>
                        <div class="modal-footer">
                           <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                           <button type="button" class="btn btn-info" onclick="window.location.href='/showVehicle/@vehicle.id'">More options <i class="glyphicon glyphicon-wrench"></i>
                           </button>
                        </div>
                     </div>
                  </div>
               </div>
               }
            </tbody>
         </table>
      </div>
   </div>
</div>
<script type="text/javascript">
   $(document).ready(function(){
       $('#myTable').DataTable();
   });
</script>
<script>
   var checkboxes = $("input[type='checkbox']"),
   submitButt = $("button[type='submit']");
   submitButt1 = $("select");
   
   checkboxes.click(function() {
   submitButt.attr("disabled", !checkboxes.is(":checked"));
   submitButt1.attr("disabled", !checkboxes.is(":checked"));
   
   });
</script>
<script>
   var elems = $('[id^="chk"]');
   
   elems.on('change', function() {
       $('#taSignOff').val(
           elems.filter(':checked').map(function() {
               return this.value;
           }).get().join(",")
       );
       $('#taSignOff1').val(
               elems.filter(':checked').map(function() {
                   return this.value;
               }).get().join(",")
           );
       $('#taSignOff2').val(
               elems.filter(':checked').map(function() {
                   return this.value;
               }).get().join(",")
           );
   });
</script>
}